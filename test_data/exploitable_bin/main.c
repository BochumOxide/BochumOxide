// compile with gcc -m32 -fno-stack-protector -o exploitable main.c
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <stdbool.h>
#include <time.h>

void win() {
	system("/bin/sh");
}

bool ask_question() {
	int num_1, num_2, answer;

	num_1 = rand() % 100;
	num_2 = rand() % 100;

	printf("What is %d + %d?\n", num_1, num_2);

	scanf(" %d", &answer);

	return (num_1 + num_2 == answer);
}

void ignore_me_init_buffering() {
	setvbuf(stdout, NULL, _IONBF, 0);
	setvbuf(stdin, NULL, _IONBF, 0);
	setvbuf(stderr, NULL, _IONBF, 0);
}

void play_game() {
	int i;
	char name[32];

	srand(time(NULL));
	printf("Hello from play_game @%d\n", (int)&play_game);
	puts("Welcome!");

	for(i = 0; i < 5; i++) {
		if(!ask_question()) {
			puts("Wrong answer!");
			exit(1);
		}
	}

	printf("Congratz you made it! Now enter your name!\n");
	scanf(" %s", name);

	printf("You made it, %s\n", name);
}

int main() {
	ignore_me_init_buffering();
	play_game();
	return 0;
}